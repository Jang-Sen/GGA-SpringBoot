<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.springboot.gga.repository.ProductOrderMapper">
    <insert id="insertOne" parameterType="Map" useGeneratedKeys="true" keyProperty="poid" keyColumn="poid">
        insert into gga_product_order(poid, pid, couponid, id, qty, finalprice, podate, couponname)
        values(#{poid}, #{pid},
        <if test="couponid == null">
            #{couponid, jdbcType=NULL},
        </if>
        <if test="couponid != null">
            #{couponid},
        </if>
               #{id}, 1, #{finalAmount}, sysdate, #{couponname})
    </insert>

    <select id="selectOne" parameterType="String" resultType="com.springboot.gga.dto.ProductOrderDto">
        SELECT po.poid, po.pid, po.couponid, po.id, po.qty, po.finalprice, po.podate, po.couponname,
               p.pname, p.GSFILE
        FROM gga_product_order po
                 INNER JOIN gga_product p ON po.pid = p.pid
        WHERE po.poid = #{poid}
    </select>

    <select id="myList" parameterType="String" resultType="com.springboot.gga.dto.ProductOrderDto">
        SELECT po.poid, po.pid, po.couponid, po.id, po.qty, po.finalprice, po.podate, po.couponname,
               p.pname, p.GSFILE
        FROM gga_product_order po
                 INNER JOIN gga_product p ON po.pid = p.pid
        WHERE po.id = #{id}
        order by po.podate desc
    </select>

</mapper>